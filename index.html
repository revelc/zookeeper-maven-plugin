<!DOCTYPE html>
<!--
 | Generated by Apache Maven Doxia Site Renderer 1.9.1 from src/site/markdown/index.md.vm
 | Rendered using Apache Maven Fluido Skin 1.9
-->
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="generator" content="Apache Maven Doxia Site Renderer 1.9.1" />
    <title>ZooKeeper Maven Plugin &#x2013; Description</title>
    <link rel="stylesheet" href="./css/apache-maven-fluido-1.9.min.css" />
    <link rel="stylesheet" href="./css/site.css" />
    <link rel="stylesheet" href="./css/print.css" media="print" />
    <script src="./js/apache-maven-fluido-1.9.min.js"></script>
  </head>
  <body class="topBarDisabled">
    <a href="https://github.com/revelc/zookeeper-maven-plugin">
      <img style="position: absolute; top: 0; right: 0; border: 0; z-index: 10000;"
        src="https://s3.amazonaws.com/github/ribbons/forkme_right_red_aa0000.png"
        alt="Fork me on GitHub">
    </a>
    <!-- Load Facebook SDK for JavaScript -->
    <div id="fb-root"></div>
    <script async defer crossorigin="anonymous" src="https://connect.facebook.net/en/sdk.js#xfbml=1&version=v6.0"></script>
    <div class="container-fluid">
      <header>
        <div id="banner">
          <div class="pull-left"><div id="bannerLeft"><h2>ZooKeeper Maven Plugin</h2>
</div>
</div>
          <div class="pull-right"></div>
          <div class="clear"><hr/></div>
        </div>

        <div id="breadcrumbs">
          <ul class="breadcrumb">
        <li id="publishDate">Last Published: 2020-09-18<span class="divider">|</span>
</li>
          <li id="projectVersion">Version: 1.2.0</li>
          </ul>
        </div>
      </header>
      <div class="row-fluid">
        <header id="leftColumn" class="span2">
          <nav class="well sidebar-nav">
  <ul class="nav nav-list">
   <li class="nav-header">Overview</li>
    <li class="active"><a href="#"><span class="none"></span>Introduction</a></li>
    <li><a href="plugin-info.html" title="Goals"><span class="none"></span>Goals</a></li>
   <li class="nav-header">Project Documentation</li>
    <li><a href="project-info.html" title="Project Information"><span class="icon-chevron-down"></span>Project Information</a>
     <ul class="nav nav-list">
      <li><a href="ci-management.html" title="CI Management"><span class="none"></span>CI Management</a></li>
      <li><a href="dependencies.html" title="Dependencies"><span class="none"></span>Dependencies</a></li>
      <li><a href="dependency-info.html" title="Dependency Information"><span class="none"></span>Dependency Information</a></li>
      <li><a href="dependency-management.html" title="Dependency Management"><span class="none"></span>Dependency Management</a></li>
      <li><a href="distribution-management.html" title="Distribution Management"><span class="none"></span>Distribution Management</a></li>
      <li class="active"><a href="#"><span class="none"></span>About</a></li>
      <li><a href="issue-management.html" title="Issue Management"><span class="none"></span>Issue Management</a></li>
      <li><a href="licenses.html" title="Licenses"><span class="none"></span>Licenses</a></li>
      <li><a href="mailing-lists.html" title="Mailing Lists"><span class="none"></span>Mailing Lists</a></li>
      <li><a href="plugin-management.html" title="Plugin Management"><span class="none"></span>Plugin Management</a></li>
      <li><a href="plugins.html" title="Plugins"><span class="none"></span>Plugins</a></li>
      <li><a href="scm.html" title="Source Code Management"><span class="none"></span>Source Code Management</a></li>
      <li><a href="summary.html" title="Summary"><span class="none"></span>Summary</a></li>
      <li><a href="team.html" title="Team"><span class="none"></span>Team</a></li>
     </ul></li>
    <li><a href="project-reports.html" title="Project Reports"><span class="icon-chevron-right"></span>Project Reports</a></li>
  </ul>
          </nav>
          <div class="well sidebar-nav">
<form id="search-form" action="https://www.google.com/search" method="get" >
  <input value="$sitesearchValue" name="sitesearch" type="hidden"/>
  <input class="search-query" name="q" id="query" type="text" />
</form>
<script>asyncJs( 'https://cse.google.com/brand?form=search-form' )</script>
            <hr />
            <div id="poweredBy">
    <div class="fb-like" style="border:none; margin-top: 10px" data-href="https://code.revelc.net/zookeeper-maven-plugin" data-layout="box_count" data-show-faces="false" data-action="like" data-share="false"></div>
              <div class="clear"></div>
              <div class="clear"></div>
              <div class="clear"></div>
<a href="http://maven.apache.org/" title="Built by Maven" class="poweredBy"><img class="builtBy" alt="Built by Maven" src="./images/logos/maven-feather.png" /></a>
            </div>
          </div>
        </header>
        <main id="bodyColumn"  class="span10" >
<!--
  Licensed under the Apache License, Version 2.0 (the "License");
  you may not use this file except in compliance with the License.
  You may obtain a copy of the License at

      http://www.apache.org/licenses/LICENSE-2.0

  Unless required by applicable law or agreed to in writing, software
  distributed under the License is distributed on an "AS IS" BASIS,
  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
  See the License for the specific language governing permissions and
  limitations under the License.
-->
<section>
<h2><a name="Description"></a>Description</h2>
<p>This zookeeper-maven-plugin enables integration testing for applications utilizing ZooKeeper servers. It will enable you to start a ZooKeeper server prior to running integration tests, and then enable you to shut it down gracefully. This plugin was inspired by the <a class="externalLink" href="http://eclipse.org/jetty/documentation/current/jetty-maven-plugin.html">jetty-maven-plugin</a> and behaves similarly, using a shutdownString and shutdownPort to shut down a specific instance during different phases of a <a class="externalLink" href="https://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html">Maven build lifecycle</a>.</p>
<p>Configuration options are available for many of ZooKeeper&#x2019;s own configuration options. It uses the ${project.build.directory}/zmp to store its running state, including the ZooKeeper dataDir. Multiple concurrent executions are possible, but must each must specify a unique clientPort and shutdownPort option.</p></section><section>
<h2><a name="Getting_Started"></a>Getting Started</h2>
<p>To add this plugin to your project, configure the plugin similarly to:</p>

<div>
<div>
<pre class="source">  &lt;build&gt;
    &lt;plugins&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;net.revelc.code&lt;/groupId&gt;
        &lt;artifactId&gt;zookeeper-maven-plugin&lt;/artifactId&gt;
        &lt;version&gt;1.2.0&lt;/version&gt;
        &lt;configuration&gt;
          &lt;!-- This is a unique string to kill the service when finished --&gt;
          &lt;shutdownString&gt;UniqueShutDownString&lt;/shutdownString&gt;
          &lt;!-- This is the port the plugin listens on for the shutdownString --&gt;
          &lt;shutdownPort&gt;21122&lt;/shutdownPort&gt;
          &lt;!-- Configure the ZooKeeper port; defaults to listening on 127.0.0.1 --&gt;
          &lt;clientPort&gt;21123&lt;/clientPort&gt;
        &lt;/configuration&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;!-- In this example, only one ZooKeeper service is started and the
            two goals share the same configuration, so the stop goal sends the
            same shutdown message that the start goal is listening for --&gt;
            &lt;id&gt;run-zookeeper&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;start&lt;/goal&gt;&lt;!-- runs at pre-integration-test phase --&gt;
              &lt;goal&gt;stop&lt;/goal&gt;&lt;!-- runs at post-integration-test phase --&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
      &lt;plugin&gt;
        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;
        &lt;artifactId&gt;maven-failsafe-plugin&lt;/artifactId&gt;
        &lt;version&gt;2.17&lt;/version&gt;
        &lt;executions&gt;
          &lt;execution&gt;
            &lt;!-- configure failsafe to execute some ITs which use ZooKeeper --&gt;
            &lt;id&gt;run-integration-tests&lt;/id&gt;
            &lt;goals&gt;
              &lt;goal&gt;integration-test&lt;/goal&gt;
              &lt;goal&gt;verify&lt;/goal&gt;
            &lt;/goals&gt;
          &lt;/execution&gt;
        &lt;/executions&gt;
      &lt;/plugin&gt;
    &lt;/plugins&gt;
  &lt;/build&gt;
</pre></div></div>

<p>and build your project, similarly to (it runs at the verify phase by default):</p>

<div>
<div>
<pre class="source">mvn verify
</pre></div></div>
</section><section>
<h2><a name="Retaining_ZooKeeper.E2.80.99s_Data.2FState"></a>Retaining ZooKeeper&#x2019;s Data/State</h2>
<p>By default, zookeeper-maven-plugin will create a zmp directory under your project&#x2019;s ${project.build.directory}. This directory is typically cleared and its children recreated with each new build. You can change the zmp directory providing the following configuration:</p>

<div>
<div>
<pre class="source">&lt;zmpDir&gt;/path/to/different/zmp&lt;/zmpDir&gt;
</pre></div></div>

<p>Now, future builds will create use that location, creating it if it doesn&#x2019;t exist.</p>
<p>You can take it a step further and add the following to keep data between builds.</p>

<div>
<div>
<pre class="source">&lt;keepPreviousState&gt;true&lt;/keepPreviousState&gt;
</pre></div></div>

<p>Both configurations must be present if you wish to keep data between builds. The boolean ensures the plugin itself doesn&#x2019;t delete the directory, and using a different directory than the default ensures it is safe from mvn clean (assuming the directory you&#x2019;ve chosen is outside your ${project.build.directory} and you don&#x2019;t have any special clean tasks configured).</p></section>
        </main>
      </div>
    </div>
    <hr/>
    <footer>
      <div class="container-fluid">
        <div class="row-fluid">
            <p>&#169;      2020
<a href="https://github.com/revelc">Revelc</a>
</p>
        </div>
      </div>
    </footer>
  </body>
</html>
